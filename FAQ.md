#FAQ


**Q: Какой механизм работы стакана?**

A: Когда новая заявка X попадает в стакан, она становится в очередь заявок по своему направлению и по своей цене. Внутри каждой цены заявки остортированы по времени постановки. Если стакан остался консистентным, то есть цена лучшего бида строго меньше цены лучшего аска, то на этом обработка заявки заканчивается. Если же цена лучшего бида стала не меньше цены лучшего аска, то начинается сведение заявок. 

Предположим, что заявка X была бидом, то есть заявкой на покупку. Тогда одна за одной берутся аски в порядке возрастания цены, а внутри каждой цены -- в порядке возрастания времени постановки заявки, и сводятся с заявкой X, в результате чего получается сделка по цене сводимой пассивной заявки (в данном случае аска) c объемом, равным минимуму из участвующих в сделке заявок. Объем сделки вычитается из объемов участвующих в сделке заявок. Так продолжается до тех пор, пока лучшая цена бида не станет меньше лучшей цены аска. 

-------------

**Q: Какие бывают типы заявок?**

A: В рамках данного контеста используется 2 типа заявок: лимтная заявка (limit order) и IOC (Immediate-Or-Cancel). Если после выполнения всех сведений от заявки что-то осталось, то в случае лимитной заявки она остается стоять в стакане по своей заявленной цене. В случае IOC-заявки, она сразу после выполнения всех возможных сведений удаляется из стакана. 

Рассмотрим пример. Пусть в стакане было 3 заявки на продажу: 
- объемом 10 по цене 101, поставленная в 11:00, 
- объемом 20 по цене 101, поставленная в 11:01, 
- объемом 10 по цене 102, поставленная в 11:00. 

| Цена | Объем (время постановки) |
| -- | -- |
| 101 | 10 (11:00), 20 (11:01)|
|102 | 10 (11:00) |

Пусть далее участник торгов ставит заявку на покупку X по некоторой цене с объемом 35. Рассмотрим несколько вариантов: 
1. X – лимитная по цене 101. Тогда произойдет 2 сделки объемами 10 и 20, и оставшиеся 5 лотов от X останутся стоять в стакане по цене 101. 
2. X – типа IOC по цене 101. Тогда произойдет 2 сделки, а остаток X удалится из стакана.
3. X – типа IOC по цене 102. Тогда произойдет 3 сделки объемами 10, 20 и 5 по ценам 101, 101 и 102, и от X ничего не останется.

-------------

**Q: У меня не получается прогнать стратегии из пакета для локальной рарзработки. Что делать?**

A: Убедитесь, что на вашей системе установлен:
- python 2.7.x или 3.x (`python --version`),
- cmake 2.8.4 и выше, 
- компилятор C++:
    - для Linux – компилятор g++ 4.9 и выше (`g++ --version`),
    - для Mac OS – Apple LLVM version 6.0 и выше, (`c++ --version`),
    - для Windows - MinGW-w64 4.9 и выше.

Подробнее в разделе [Установка зависимостей](./local-pack/requirements.md).

--------------
**Q: Есть ли временная задержка между моментом отправки заявки и временем ее постановки в стакан?**

A: Время, прошедшее от отправки заявки на биржу до его приема биржей, называется *roundtrip*-ом. В симуляторе *roundtrip* полагается равным нулю. Это значит, что все ваши запросы на добавление/удаление заявок производятся мгновенно, без имитации времени "полета" до биржи.

-------------
**Q: Как из trading_book_snapshot обратиться к стакану заявок?**

A: Стакан заявок можно получить, используя следующую конструкцию:
```c++
const OrderBook *new_book = reinterpret_cast<const BookSnapshot *>(trading_book_snapshot.get())->book();
```

-------------

