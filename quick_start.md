# Краткое описание {{ book["contest.name"] }}
Здесь описаны основные особенности системы контеста. Данная страница не претендует на полноту, это лишь краткое описание, позволяющее быстро погрузиться в соревнование!

* [Организация соревнования](#org)
* [Симулятор торгов](#simulator)
* [Интерфейс участника](#interface)
* [Пакет для локальной разработки](#local-pack)
* [Биржевые данные](#exchange)
* [Анализ биржевого стакана с помощью Viewer](#viewer)

<a name="org"></a>
## Организация соревнования
В соревновании есть три типа посылок:
- [Тренировочные посылки](interface/modes.md#training_mode) - их количество почти не ограничено, используйте их для разработки и улучшения своих стратегий. 
- [Контрольные](interface/modes.md#control_mode) - вы можете делать по 2 таких посылки в день. В этом режиме ваши стратегии будут запущены на новом наборе дней, который недоступен в режиме тренировки - это нужно, чтобы вы смогли оценить, насколько ваша стратегия обобщается на новые данные. Кроме того, контрольные посылки участвуют в [общем рейтинге](https://arena.hftbattle.com/leaderboard).
- [Еженедельные](interface/modes.md#weekly_mode) - каждую неделю выбранная вами стратегия (либо лучшая среди контрольных запусков) будет запущена на асболютно новых данных. Результаты этих запусков будут публиковаться каждую неделю, и по последнему такому запуску будет сформирован финальный рейтинг.

По окончанию основного этапа соревнования будет произведено [Финальное тестирование](interface/modes.md#final_test).

<a name="simulator"></a>
## Симулятор торгов
- Есть три ограничения, приближающих симулятор торгов к реальности: 
    - максимальный размер открытой [позиции](terms#position) ограничен 50 лотами на покупку и на продажу (для справки: этот размер позиции требует около 500 тыс.$ средств на брокерском счете)
    - минимальный результат = -50000$. Если достигли его, то стратегия автоматически завершает работу на этом дне.
    - комиссия = 0.5$ за каждый лот в сделке. (для справки: реальная биржевая комиссия составляет 1.17$)
- События, приходящие в стратегию, бывают трех видов:  [обновление стакана](api/ParticipantStrategy.md#trading_book_update), [обновление сделок](api/ParticipantStrategy.md#trading_deals_update) и [отчет о вашей сделке](api/ParticipantStrategy.md#execution_report_update). При этом, если случилась ваша сделка, то сначала придет обновление сделок, потом - обновление стакана и только после этого сообщение об изменении стакана. 
- Реализованы жесткие ограничения на набираемую [позицию](api/ContestBookInfo.md#total_amount), то есть разницу числа купленных и проданных лотов, поэтому не удивляйтесь, если методы добавления заявок [add_limit_order](api/ParticipantStrategy.md#add_limit_order) и [add_ioc_order](api/ParticipantStrategy.md#add_ioc_order) будут возвращать *false*. Внимательнее смотрите в логи стратегии, там содержится информация по всем вашим заявкам и сделкам.

Подробнее в разделе [Симулятор торгов](simulator/README.md).

<a name="interface"></a>
## Интерфейс участника
- К посылкам можно писать комментарии, чтобы не забыть, какую именно идею вы проверяли. Также посылки можно помечать как  "избранные" (звездочка в строке с посылкой), чтобы облегчить себе навигацию в будущем.
- Чтобы выбрать стратегию, которая прогонится на еженедельном тестировании,  нужно пометить строчку с этой посылкой галочкой.
- Если интересно посмотреть как стратегия торгует на конкретном дне - советуем запускать только на нем, так будет гораздо быстрее.
- Ну а чтобы выжать максимальный результат из вашей идеи, попробуйте [перебрать параметры стратегии](interface/params.md).

Подробнее в разделе [Интерфейс участника](interface/README.md).


<a name="local-pack"></a>
## Пакет для локальной разработки
- Самый простой способ начать разрабатывать в локальном пакете – [скачать](https://s3.eu-central-1.amazonaws.com/hftbattle/vm-hftbattle.ova) подготовленный образ Ubuntu 14.04 для VirtualBox.
На нем уже имеетcя пакет для локальной разработки и установлены необходимые зависимости. Пользователь: `user`,  пароль: `hftbattle`.
Пакет для локальной разработки находится в папке `hftbattle` в домашней директории. Чтобы обновить его до актуальной версии, выполните команду `git pull`.
Также на виртуалке имеется скачанный CLion с 30-дневным периодом бесплатного использования. Для запуска CLion выполните команду `./clion/bin/clion.sh` из домашней директории. О том, как запустить симулятор из CLion читайте в разделе [Запуск стратегии](local-pack/run_strategy.md).
- Мы опубликовали на [GitHub]({{contest.local-pack.url}}) набор библиотек и файлов, достаточный для разработки и тестирования стратегий на вашем компьютере:
```
git clone https://github.com/hftbattle/hftbattle.git
```
- Для работы с пакетом необходим компилятор g++ 4.9 и выше, а также CMake 2.8.4 и выше.
- Стратегия описывается в одном cpp-файле. Каждой стратегии соответствует одноименный json-файл.
- Чтобы собрать все имеющиеся в папке *strategies* стратегии, нужно запустить python-скрипт *build.py*, находящийся в корне репозитория:
```
> ./build.py
```
- Чтобы запустить нужную вам стратегию, нужно запустить python-скрипт *run.py*, передав ему в качестве аргумента путь до конфига стратегии:
```
> ./run.py strategies/user_strategy/user_strategy.json
```
- При создании новых стратегий в пакете для локальной разработки, нужно менять строчку с регистрацией стратегии в конце cpp-файла:
```
REGISTER_CONTEST_STRATEGY(UserStrategy, best_strategy_ever)
```
Подробнее в разделе [Пакет для локальной разработки](local-pack/README.md).

<a name="exchange"></a>
## Биржевые данные
- Для симуляции торгов используются данные фьючерса S&P Mini Чикагской товарной биржи [CME]({{ book["wiki.cme.url"] }}). 
- Торговая сессия начинается в 2 ночи по Москве (UTC+3), заканчивается в 23:45.
- На выбранном инструменте происходит порядка 5-10 миллионов биржевых событий в день.
- С биржи приходят данные только о количестве лотов на каждой цене, без разбиения на заявки внутри цен. Однако в симуляторе это разбиение воспроизводится с большой точностью. Поэтому можно узнать на каком месте в очереди находится ваша заявка, используя метод [get_amount_before_order](api/ParticipantStrategy.md#get_amount_before_order).
- У каждого инструмента есть "цена в пунктах", которая и показывается в стакане. По этим ценам совершаются сделки и т.д. В нашем случае 1 пункт = 0.5$, а минимальный шаг цены в стакане равен 25 пунктов ( = 12.5$).

<a name="viewer"></a>
## Анализ биржевого стакана с помощью Viewer
- По адресу [{{ book["viewer.name"] }}]({{ book["viewer.url"] }}) вам доступен инструмент для визуализации биржевых торгов. В нем все события показываются атомарно, сделки объединены в пачки так же как они были отправлены биржей.
- Обратите внимание, что стакан во Viewer – это реальный стакан, то есть список пар <цена, суммарный объем на цене>, реально имевшихся на бирже в данный момент. На него вы влиять не могли.
- - Нажав на точку на графике с результатом и позицией, можно перейти во Viewer, и там отобразятся ваши заявки и сдлелки в районе того момента.
- Можно ходить как по всем событиям, так и только по своим.

Подробнее в разделе [Viewer](interface/analysis/viewer.md).
